<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Rezeptdetails</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <div class="cook-navbar">
        <nav>
            <li><a href="/index.html">Startseite</a></li>
            <li><a href="#">Rezepte</a></li>
        </nav>
    </div>
    <div class="card-overview" id="rezeptDetail">
        <h2 id="rezeptTitel">Lade Rezept...</h2>
        <p id="rezeptBeschreibung"></p>
        <!-- Optional: Zutatenliste etc. -->
    </div>

    <script>
        const rezeptId = window.location.pathname.split("/").pop();
        const container = document.getElementById('rezeptDetail');

        fetch('/api/rezept/' + rezeptId)
            .then(response => {
                if (!response.ok) throw new Error("Rezept nicht gefunden");
                return response.json();
            })
            .then(r => {
                container.innerHTML = ''; // Alte Ladeanzeige entfernen

                // Titel
                const titel = document.createElement('h2');
                titel.textContent = r.titel;
                container.appendChild(titel);

                // Beschreibung
                const beschreibung = document.createElement('p');
                beschreibung.textContent = r.beschreibung || 'Keine Beschreibung vorhanden.';
                container.appendChild(beschreibung);

                // Kategorien
                const katTitel = document.createElement('p');
                katTitel.className = 'section-title';
                katTitel.textContent = 'Kategorien:';
                container.appendChild(katTitel);
                if (r.kategorien.length === 0) {
                    const keineKat = document.createElement('p');
                    keineKat.textContent = 'Keine Kategorien vorhanden.';
                    container.appendChild(keineKat);
                } else {
                    const katListe = document.createElement('ul');
                    r.kategorien.forEach(k => {
                        const li = document.createElement('li');
                        li.textContent = k.name || k; // Falls Kategorien nur Strings sind
                        katListe.appendChild(li);
                    });
                    container.appendChild(katListe);
                }

                // Zutaten
                const zutTitel = document.createElement('p');
                zutTitel.className = 'section-title';
                zutTitel.textContent = 'Zutaten:';
                container.appendChild(zutTitel);
                if (r.zutaten.length === 0) {
                    const keineZut = document.createElement('p');
                    keineZut.textContent = 'Keine Zutaten vorhanden.';
                    container.appendChild(keineZut);
                } else {
                    const zutListe = document.createElement('ul');
                    r.zutaten.forEach(z => {
                        const li = document.createElement('li');
                        li.textContent = z.name;
                        zutListe.appendChild(li);
                    });
                    container.appendChild(zutListe);
                }

                // Zeitaufwand
                const zeit = document.createElement('p');
                zeit.innerHTML = `<span class="section-title">Zeitaufwand:</span> ${r.zeitaufwand ?? 'Keine Angabe'}`;
                container.appendChild(zeit);

                // Schwierigkeitsgrad
                const schwierig = document.createElement('p');
                schwierig.innerHTML = `<span class="section-title">Schwierigkeitsgrad:</span> ${r.schwierigkeitsgrad ?? 'Keine Angabe'}`;
                container.appendChild(schwierig);

                // Bilder (Annahme: Array mit URLs)
                const bilderTitel = document.createElement('p');
                bilderTitel.className = 'section-title';
                bilderTitel.textContent = 'Bilder:';
                container.appendChild(bilderTitel);

                if (!r.bilder || r.bilder.length === 0) {
                    const keineBilder = document.createElement('p');
                    keineBilder.textContent = 'Keine Bilder vorhanden.';
                    container.appendChild(keineBilder);
                } else {
                    r.bilder.forEach(url => {
                        const img = document.createElement('img');
                        img.src = "/images/" + url;
                        img.alt = 'Rezeptbild';
                        img.style.maxWidth = '100%';
                        img.style.marginBottom = '10px';
                        container.appendChild(img);
                    });
                }

                // Nutzer
                const nutzer = document.createElement('p');
                nutzer.innerHTML = `<span class="section-title">Nutzer:</span> ${r.nutzer ?? 'Keine Angabe'}`;
                container.appendChild(nutzer);

                // Kommentare (angenommen Array mit Objekten oder Strings)
                const komTitel = document.createElement('p');
                komTitel.className = 'section-title';
                komTitel.textContent = 'Kommentare:';
                container.appendChild(komTitel);

                if (!r.kommentare || r.kommentare.length === 0) {
                    const keineKom = document.createElement('p');
                    keineKom.textContent = 'Keine Kommentare vorhanden.';
                    container.appendChild(keineKom);
                } else {
                    const komListe = document.createElement('ul');
                    r.kommentare.forEach(k => {
                        const li = document.createElement('li');
                        // Falls Kommentar ein Objekt, passe hier an:
                        li.textContent = (typeof k === 'string') ? k : JSON.stringify(k);
                        komListe.appendChild(li);
                    });
                    container.appendChild(komListe);
                }

                // Bewertungen (ebenfalls Array)
                const bewTitel = document.createElement('p');
                bewTitel.className = 'section-title';
                bewTitel.textContent = 'Bewertungen:';
                container.appendChild(bewTitel);

                if (!r.bewertungen || r.bewertungen.length === 0) {
                    const keineBew = document.createElement('p');
                    keineBew.textContent = 'Keine Bewertungen vorhanden.';
                    container.appendChild(keineBew);
                } else {
                    const bewListe = document.createElement('ul');
                    r.bewertungen.forEach(b => {
                        const li = document.createElement('li');
                        li.textContent = (typeof b === 'string') ? b : JSON.stringify(b);
                        bewListe.appendChild(li);
                    });
                    container.appendChild(bewListe);
                }
            })
            .catch(err => {
                container.innerHTML = '<p>Fehler: Rezept konnte nicht geladen werden.</p>';
                console.error(err);
            });
    </script>
</body>
</html>
